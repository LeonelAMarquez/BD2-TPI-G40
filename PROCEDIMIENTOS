CREATE PROCEDURE sp_AgregarProductoBebida
    @nombre NVARCHAR(150),
    @descripcion NVARCHAR(255),
    @precio DECIMAL(10,2),
    @marca NVARCHAR(50),
    @id_proveedor INT
AS
BEGIN
    SET NOCOUNT ON;

    -- Validar marca permitida
    IF UPPER(@marca) NOT IN ('INCA', 'BAGGIO', 'SIDRA', 'SIDRAS')
    BEGIN
        PRINT 'Marca no permitida. Solo se aceptan INCA, BAGGIO o SIDRAS.';
        RETURN;
    END;

    -- Validar proveedor existente
    IF NOT EXISTS (SELECT 1 FROM Proveedor WHERE id_proveedor = @id_proveedor)
    BEGIN
        PRINT 'El proveedor especificado no existe.';
        RETURN;
    END;

    -- Insertar nuevo producto
    INSERT INTO Producto (nombre, descripcion, precio, id_proveedor)
    VALUES (@nombre, @descripcion, @precio, @id_proveedor);

    DECLARE @nuevo_id INT = SCOPE_IDENTITY();

    -- Crear registro en tabla Stock
    INSERT INTO Stock (id_producto, cantidad)
    VALUES (@nuevo_id, 0);

    PRINT 'Producto agregado correctamente: ' + @nombre + ' (' + @marca + ')';
END;
GO

